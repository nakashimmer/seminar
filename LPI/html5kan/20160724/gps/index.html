
<!DOCTYPE html>
<meta charset=utf-8>
<title>セマン</title>
<style>
	*{
		margin:0;padding:0;
		box-sizing:border-box;
	}
	#wrap{
		margin:0px auto;
		width:600px;
		height:400px;
		border:1px solid gray;
		background:linear-gradient(skyblue,white 15%);
		transform-style:preserve-3d;
		perspective:300px;
		overflow:hidden;
		position:relative;
	}
	
	main{
		transform:rotateX(30deg);
		transform-origin:center center;
		position:absolute;
		width:700px;
		height:500px;
	}
	#chizu{
		margin-left:-150px;
		width:900px; height:400px;
	}
	#arrow{
		background-image:url(seman.png);
		background-size:200% 100%;
		background-position:right top;
		height:100px;width:100px;
		position:absolute;
		top:250px;left:240px;
		transition:transform 0.5s ease-in-out;
	}
</style>

<script src="https://maps.google.com/maps/api/js?key=AIzaSyD6A3ILDkpS2KuVV1SlAAJtBTv5lMfnkwY""></script>

<div id=wrap>
	<main id=main>
		<div id="chizu">地図</div>
	</main>
	<div id=arrow></a>
</div>



<script>
	function $(id){return document.getElementById(id);}


	//Android用
	var option={enableHighAccuracy:true,timeout:10000,maximumAge:0};
	
	var nav;
navigator.geolocation.getCurrentPosition(
			seiko,shippai,option
		);
	
	var ido,keido;
	var image = 'marker.png';
	
	//成功
	var marker,mido,mkeido;
	var chizu = document.getElementById("chizu");
	function seiko(position){
		ido = position.coords.latitude;
		keido = position.coords.longitude;
		var genzaichi = new google.maps.LatLng(ido,keido);
		var gmap = new google.maps.Map(
			chizu,{zoom:18,center:genzaichi,mapTypeId:google.maps.MapTypeId.ROADMAP}
		);
		
		
		mido=ido+0.001;
		mkeido=keido+0.001;
		marker = new google.maps.Marker({
			position: {lat:mido, lng: keido},
			map: gmap,
			icon: image
		});
		
		google.maps.event.addListener(marker, 'click',function(){
      location.href = "seman2";
    });
	}

	//失敗
	function shippai(err){
	}

	var pos={x:0,y:0};
	var posTemp={x:0,y:0};
	var dirChange=false;
	$("chizu").addEventListener("mousemove",function(e){
		pos.x=e.clientX;
		pos.y=e.clientY;

		var gap={x:0,y:0};
		gap.x= pos.x-posTemp.x;
		gap.y= pos.y-posTemp.y;
		
		if(dirChange){
			if(gap.x>3){var tr="skew(0,30deg)";}
			if(gap.x<-3){var tr="skew(0,-30deg)";}
			if(gap.y<-3){var tr="skew(0,0deg)";}
			$("arrow").style.transform=tr;
			if(gap.y>3){$("arrow").style.backgroundPosition="left top";}
			if(gap.y<-1){$("arrow").style.backgroundPosition="right top";}

		}
		
		
		posTemp.x=pos.x;posTemp.y=pos.y;
	});
	
	$("chizu").addEventListener("mousedown",function(e){
		dirChange=true;
	})
	$("chizu").addEventListener("mouseup",function(e){
		dirChange=false;
	})
</script>